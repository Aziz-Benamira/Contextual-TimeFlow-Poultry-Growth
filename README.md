# Contextual TimeFlow for Poultry Growth Simulation

This repository contains the code and research for the project "Continuous Modeling of Avian Growth for Farming Scenario Simulation," conducted as a research internship at MIA Paris-Saclay, INRAE.

## Abstract

This project addresses the challenge of modeling broiler chicken growth, a complex time-series problem, within the context of the **TwinFarms** digital twin initiative. We moved beyond standard sequential models by developing a novel architecture, the **Contextual TimeFlow**, which leverages Implicit Neural Representations (INRs) and Meta-Learning. The key contribution is a disentangled latent representation that separates observable farming conditions (the "context") from the flock's intrinsic, unexplained variability (the "residual"). This structure allowed us to not only improve predictive accuracy by over 30% but also to build a robust **"cold start" simulation pipeline**, capable of generating entire growth curves from farming parameters alone, without any historical weight data.

## Key Features

-   **ðŸ§  State-of-the-Art Architecture:** Implements a *Contextual TimeFlow* model, enhancing the original TimeFlow by disentangling its latent space for better control and interpretability.
-   **ðŸ”® "Cold Start" Simulation:** Features a complete simulation pipeline using an auxiliary XGBoost model to predict the residual latent code.
-   **ðŸ“Š Rigorous Evaluation:** Provides code to compare the model's performance against a non-contextual baseline and standard time-series models like ARIMAX and Prophet.

## Architecture Overview

The model is based on a meta-learning process with two nested loops. The **inner loop** adapts a residual latent code (`Z-rÃ©sidu`) to match a known weight history. The **outer loop** updates the global model parameters (`Î¸`, `w`) based on the prediction error on a future horizon. Our contribution was to explicitly provide farming conditions (`Z-contexte`) to the model, generated by a dedicated tower of encoders.

*You can add your architecture diagram here:*
`![Architecture Diagram](images/architecture_meta.png)`

## Reproducibility Guide

This project is contained within a single Jupyter/Colab notebook: `main_notebook.ipynb`. To reproduce the results, please follow the steps below.

### 1. Installation

It is recommended to use a virtual environment (e.g., `venv` or `conda`).

```bash
# Clone the repository
git clone https://github.com/your-username/Contextual-TimeFlow-Poultry-Growth.git
cd Contextual-TimeFlow-Poultry-Growth
```
# Install the required packages
pip install -r requirements.txt
requirements.txt should contain:
torch
pandas
numpy
scikit-learn
xgboost
pmdarima
prophet
plotly
kaleido
matplotlib
tqdm


### 2. Data Placement

Due to confidentiality, the raw data is not provided in this repository.

### 3. Usage: Running the Notebook

Open `main_notebook.ipynb` and execute the cells sequentially. The notebook is structured in logical sections. It is recommended to run them in the following order:


## Acknowledgments
This work was conducted at MIA Paris-Saclay - INRAE and supervised by Vincent GUIGUE (INRAE).
Created by [Aziz BEN AMIRA]([Link to your LinkedIn])
